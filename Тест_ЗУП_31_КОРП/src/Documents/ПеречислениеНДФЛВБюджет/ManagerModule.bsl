#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда
	
#Область ПрограммныйИнтерфейс

// СтандартныеПодсистемы.ВерсионированиеОбъектов

// Определяет настройки объекта для подсистемы ВерсионированиеОбъектов.
//
// Параметры:
//  Настройки - Структура - настройки подсистемы.
Процедура ПриОпределенииНастроекВерсионированияОбъектов(Настройки) Экспорт

КонецПроцедуры

// Конец СтандартныеПодсистемы.ВерсионированиеОбъектов

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ЗаполнитьРеквизитыПлатежныхПоручений() Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ПеречислениеНДФЛВБюджет.Ссылка,
	|	ПеречислениеНДФЛВБюджет.ПлатежноеПоручениеНомер,
	|	ПеречислениеНДФЛВБюджет.ПлатежноеПоручениеДата
	|ИЗ
	|	Документ.ПеречислениеНДФЛВБюджет КАК ПеречислениеНДФЛВБюджет
	|ГДЕ
	|	ПеречислениеНДФЛВБюджет.РеквизитыПлатежногоПоручения = """"";
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		
		Объект = Выборка.Ссылка.ПолучитьОбъект();
		
		Объект.РеквизитыПлатежногоПоручения = Объект.РеквизитыПлатежногоПоручения();
			
		ОбновлениеИнформационнойБазы.ЗаписатьОбъект(Объект);
		
	КонецЦикла;	
	
КонецПроцедуры	

Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	УчетНДФЛРасширенный.ДобавитьКомандуПечатиРеестраПеречисленногоНалога(КомандыПечати)
	
КонецПроцедуры

Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ПФ_MXL_РеестрПеречисленныхСумм") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, 
			"ПФ_MXL_РеестрПеречисленныхСумм", 
			НСтр("ru = 'Реестр перечисленных сумм'"),
			ПечатьРеестра(МассивОбъектов, ОбъектыПечати), , "ОбщийМакет.ПФ_MXL_РеестрПеречисленныхСуммНДФЛ");	
	КонецЕсли;
	
КонецПроцедуры

Функция ПечатьРеестра(МассивОбъектов, ОбъектыПечати)
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("МассивОбъектов", МассивОбъектов);
	
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ПеречислениеНДФЛВБюджет.Организация,
	|	ПеречислениеНДФЛВБюджет.МесяцНалоговогоПериода,
	|	ПеречислениеНДФЛВБюджет.РегистрацияВНалоговомОргане,
	|	ПеречислениеНДФЛВБюджет.ДатаПлатежа,
	|	ПеречислениеНДФЛВБюджет.ПлатежноеПоручениеНомер,
	|	ПеречислениеНДФЛВБюджет.ПлатежноеПоручениеДата,
	|	ПеречислениеНДФЛВБюджет.ГлавныйБухгалтер,
	|	ПеречислениеНДФЛВБюджет.Бухгалтер
	|ИЗ
	|	Документ.ПеречислениеНДФЛВБюджет КАК ПеречислениеНДФЛВБюджет
	|ГДЕ
	|	ПеречислениеНДФЛВБюджет.Ссылка В(&МассивОбъектов)";
				   
	ТабличныйДокумент = УчетНДФЛ.РеестрПеречисленныхСуммНалога(Запрос.Выполнить().Выгрузить());
	
	УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 1, ОбъектыПечати, ?(ЗначениеЗаполнено(МассивОбъектов), МассивОбъектов[0], Документы.ПеречислениеНДФЛВБюджет.ПустаяСсылка()));
	
	Возврат ТабличныйДокумент;
	
КонецФункции

#КонецОбласти

#КонецЕсли
