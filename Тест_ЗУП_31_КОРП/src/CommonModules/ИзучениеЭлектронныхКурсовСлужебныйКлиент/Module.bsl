
#Область СлужебныеПроцедурыИФункции

// Открывает электронный курс для просмотра, редактирования или проверки.
//
Процедура ОткрытьЭлектронныйКурс(ЭлектронныйКурс,
							  Контекст = Неопределено,
							  Учащийся = Неопределено,
							  ВладелецФормы = Неопределено,
							  РежимПроверки = Ложь,
							  РежимРедактирования = Ложь,							  							  
							  РежимОткрытияОкна = Неопределено,
							  Заголовок = Неопределено,
							  Окно = Неопределено) Экспорт
							  
	Если НЕ ЗначениеЗаполнено(ЭлектронныйКурс) Тогда
		ВызватьИсключение НСтр("ru = 'Электронный курс не задан'");
	КонецЕсли;							  
							  
	ПараметрыФормы = Новый Структура;
	ПараметрыФормы.Вставить("ЭлектронныйКурс", ЭлектронныйКурс);
	ПараметрыФормы.Вставить("Контекст", Контекст);
	ПараметрыФормы.Вставить("РежимПроверки", РежимПроверки);
	ПараметрыФормы.Вставить("РежимРедактирования", РежимРедактирования);
	ПараметрыФормы.Вставить("Учащийся", Учащийся);
	ПараметрыФормы.Вставить("Заголовок", Заголовок);
	
	ОткрытьФорму("ОбщаяФорма.ЭлектронныйКурс", ПараметрыФормы, ВладелецФормы,, Окно,,, РежимОткрытияОкна);
	
КонецПроцедуры

Процедура РедактироватьЭлектронныйКурс(Знач ЭлектронныйКурс) Экспорт
	
	Если ТипЗнч(ЭлектронныйКурс) = Тип("ДанныеФормыСтруктура") Тогда
		ПоказатьЗначение(, ЭлектронныйКурс.Ссылка);
	КонецЕсли;
	
	Если ТипЗнч(ЭлектронныйКурс) = Тип("СправочникСсылка.ЭлектронныеКурсы") Тогда
		ПоказатьЗначение(, ЭлектронныйКурс);
	КонецЕсли;
		
КонецПроцедуры

Процедура СоздатьЭлектронныйКурс(Знач Тип, ПараметрыВыполненияКоманды = Неопределено) Экспорт
	
	ПараметрыФормы = Новый Структура();
	ПараметрыФормы.Вставить("ЗначенияЗаполнения", Новый Структура("Тип", Тип));
	
	Если ПараметрыВыполненияКоманды = Неопределено Тогда	
		ОткрытьФорму("Справочник.ЭлектронныеКурсы.ФормаОбъекта", ПараметрыФормы);		
	Иначе		
		ОткрытьФорму("Справочник.ЭлектронныеКурсы.ФормаОбъекта", ПараметрыФормы, ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность, ПараметрыВыполненияКоманды.Окно, ПараметрыВыполненияКоманды.НавигационнаяСсылка);		
	КонецЕсли;	
		
КонецПроцедуры

#КонецОбласти
