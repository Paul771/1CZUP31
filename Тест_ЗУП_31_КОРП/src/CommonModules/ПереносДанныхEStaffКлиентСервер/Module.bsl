////////////////////////////////////////////////////////////////////////////////
// Подсистема "Перенос данных из E-Staff Рекрутер".
//
////////////////////////////////////////////////////////////////////////////////

#Область СлужебныеПроцедурыИФункции

Функция КлючОрганизации() Экспорт
	Возврат "org";
КонецФункции

Функция КлючПодразделения() Экспорт
	Возврат "division";
КонецФункции

Функция КлючПозиции() Экспорт
	Возврат "position";
КонецФункции

Функция КлючПользователя() Экспорт
	Возврат "user";
КонецФункции

Функция КлючГруппыДоступа() Экспорт
	Возврат "group";
КонецФункции

Функция КлючВакансии() Экспорт
	Возврат "vacancy";
КонецФункции

Функция КлючФизическогоЛица() Экспорт
	Возврат "person";
КонецФункции

Функция КлючКандидата() Экспорт
	Возврат "candidate";
КонецФункции

Функция КлючИсточникаИнформации() Экспорт
	Возврат "candidate_sources";
КонецФункции

Функция КлючПричиныОткрытия() Экспорт
	Возврат "vacancy_reasons";
КонецФункции

Функция КлючВалюты() Экспорт
	Возврат "currencies";
КонецФункции

Функция КлючЯзыка() Экспорт
	Возврат "skill_types";
КонецФункции

Функция КлючСтраны() Экспорт
	Возврат "countries";
КонецФункции

Функция НовоеОписаниеОбъекта(ИмяТаблицыОбъектов)
	
	ОписаниеОбъекта = Новый Структура;
	
	ОписаниеОбъекта.Вставить("ПорядокЗаписи", 1);
	ОписаниеОбъекта.Вставить("Считывается", Истина);
	ОписаниеОбъекта.Вставить("ВОдномФайле", Ложь);
	ОписаниеОбъекта.Вставить("ОписаниеФайлов", Новый Массив);
	ОписаниеОбъекта.Вставить("СопоставляетсяПользователем", Истина);
	ОписаниеОбъекта.Вставить("Иерархический", Ложь);
	ОписаниеОбъекта.Вставить("ФильтруетсяПо", "");
	ОписаниеОбъекта.Вставить("Ключ", "");
	ОписаниеОбъекта.Вставить("ИменаСвойств", "id,name");
	ОписаниеОбъекта.Вставить("ИмяСвойстваИдентификатор", "id");
	ОписаниеОбъекта.Вставить("ИмяСвойстваНаименование", "name");
	ОписаниеОбъекта.Вставить("ИмяТаблицы", ИмяТаблицыОбъектов);
	ОписаниеОбъекта.Вставить("ОписаниеТипа", Новый ОписаниеТипов("СправочникСсылка." + ИмяТаблицыОбъектов));
	
	Возврат ОписаниеОбъекта;
	
КонецФункции

Функция ОписаниеВакансии() Экспорт
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("Вакансии");
	ОписаниеОбъекта.ПорядокЗаписи = 6;
	ОписаниеОбъекта.Ключ = КлючВакансии();
	ОписаниеОбъекта.ИменаСвойств = "id,name,position_id,start_date,close_date,reason_id,recruit_type_id,difficulty_level_id,priority_id,
		|salary,min_salary,max_salary,salary_currency_id,req_close_date,state_id,state_date,comment,rr_persons,user_id,inet_data";
	
	Возврат ОписаниеОбъекта;
	
КонецФункции

Функция ОписаниеФизическогоЛица() Экспорт
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("ФизическиеЛица");
	ОписаниеОбъекта.ПорядокЗаписи = 2;
	ОписаниеОбъекта.Ключ = КлючФизическогоЛица();
	ОписаниеОбъекта.ИмяСвойстваНаименование = "fullname";
	ОписаниеОбъекта.ИменаСвойств = "id,fullname,lastname,firstname,middlename,creation_date,gender_id,birth_date,address,mobile_phone,
		|work_phone,home_phone,email,email2,marital_status_id,educ_type_id,prev_educations,group_id,is_candidate,candidate_id";
	
	Возврат ОписаниеОбъекта;
	
КонецФункции

Функция ОписаниеКандидата() Экспорт
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("Кандидаты");
	ОписаниеОбъекта.ПорядокЗаписи = 7;
	ОписаниеОбъекта.СопоставляетсяПользователем = Ложь;
	ОписаниеОбъекта.Ключ = КлючКандидата();
	ОписаниеОбъекта.ИмяСвойстваНаименование = "fullname";
	ОписаниеОбъекта.ИменаСвойств = "id,fullname,lastname,firstname,middlename,creation_date,skills,citizenship_id,children_num,spots,
		|source_id,rating,salary,salary_currency_id,start_date,state_id,state_date,user_id,person_id,prev_jobs,last_comment";
	
	Возврат ОписаниеОбъекта;
	
КонецФункции

Функция ОписаниеСтраныМира() Экспорт
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("СтраныМира");
	ОписаниеОбъекта.СопоставляетсяПользователем = Ложь;
	ОписаниеОбъекта.Ключ = КлючСтраны();
	ОписаниеОбъекта.ВОдномФайле = Истина;
	ОписаниеОбъекта.ФильтруетсяПо = "candidate.citizenship_id";
	
	Возврат ОписаниеОбъекта;
	
КонецФункции

Функция ОписанияЗагружаемыхОбъектов() Экспорт
	
	ОписанияОбъектов = Новый Массив;
	
	// Организации не фильтруются, так как их учет в E-Staff может и не вестись.
	ОписаниеОбъекта = НовоеОписаниеОбъекта("Организации");
	ОписаниеОбъекта.ПорядокЗаписи = 3;
	ОписаниеОбъекта.Ключ = КлючОрганизации();
	ОписаниеОбъекта.ИменаСвойств = "id,name,alt_name,full_name,address,legal_address,phone,email,inn,is_own_org";
	ОписанияОбъектов.Добавить(ОписаниеОбъекта);
	
	ОписанияОбъектов.Добавить(ОписаниеВакансии());
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("ШтатноеРасписание");
	ОписаниеОбъекта.ПорядокЗаписи = 5;
	ОписаниеОбъекта.Ключ = КлючПозиции();
	ОписаниеОбъекта.ФильтруетсяПо = "vacancy.position_id";
	ОписаниеОбъекта.ИменаСвойств = "id,division_id,name,start_date,end_date";
	ОписанияОбъектов.Добавить(ОписаниеОбъекта);
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("ПодразделенияОрганизаций");
	ОписаниеОбъекта.ПорядокЗаписи = 4;
	ОписаниеОбъекта.Ключ = КлючПодразделения();
	ОписаниеОбъекта.Иерархический = Истина;
	ОписаниеОбъекта.ФильтруетсяПо = "position.division_id";
	ОписаниеОбъекта.ИменаСвойств = "id,parent_id,name,org_id,start_date,end_date,is_org";
	ОписанияОбъектов.Добавить(ОписаниеОбъекта);
	
	ОписанияОбъектов.Добавить(ОписаниеФизическогоЛица());
	
	ОписанияОбъектов.Добавить(ОписаниеКандидата());
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("Пользователи");
	ОписаниеОбъекта.Ключ = КлючПользователя();
	ОписаниеОбъекта.Считывается = Ложь;
	ОписанияОбъектов.Добавить(ОписаниеОбъекта);
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("ГруппыДоступаФизическихЛиц");
	ОписаниеОбъекта.Ключ = КлючГруппыДоступа();
	ОписаниеОбъекта.Считывается = Ложь;
	ОписанияОбъектов.Добавить(ОписаниеОбъекта);
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("ПричиныОткрытияВакансий");
	ОписаниеОбъекта.Ключ = КлючПричиныОткрытия();
	ОписаниеОбъекта.ВОдномФайле = Истина;
	ОписаниеОбъекта.ФильтруетсяПо = "vacancy.reason_id";
	ОписаниеОбъекта.ИменаСвойств = "id,name,order_index";
	ОписанияОбъектов.Добавить(ОписаниеОбъекта);
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("ИсточникиИнформацииОКандидатах");
	ОписаниеОбъекта.СопоставляетсяПользователем = Ложь;
	ОписаниеОбъекта.Ключ = КлючИсточникаИнформации();
	ОписаниеОбъекта.ВОдномФайле = Истина;
	ОписаниеОбъекта.ФильтруетсяПо = "candidate.source_id";
	ОписанияОбъектов.Добавить(ОписаниеОбъекта);
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("Валюты");
	ОписаниеОбъекта.СопоставляетсяПользователем = Ложь;
	ОписаниеОбъекта.Ключ = КлючВалюты();
	ОписаниеОбъекта.ВОдномФайле = Истина;
	ОписаниеОбъекта.ФильтруетсяПо = "vacancy.salary_currency_id,candidate.salary_currency_id";
	ОписанияОбъектов.Добавить(ОписаниеОбъекта);
	
	ОписаниеОбъекта = НовоеОписаниеОбъекта("ЯзыкиНародовМира");
	ОписаниеОбъекта.СопоставляетсяПользователем = Ложь;
	ОписаниеОбъекта.Ключ = КлючЯзыка();
	ОписаниеОбъекта.Иерархический = Истина;
	ОписаниеОбъекта.ВОдномФайле = Истина;
	ОписаниеОбъекта.ФильтруетсяПо = "candidate.skills.skill.type_id";
	ОписаниеОбъекта.ИменаСвойств = "id,name,parent_id";
	ОписанияОбъектов.Добавить(ОписаниеОбъекта);
	
	ОписанияОбъектов.Добавить(ОписаниеСтраныМира());
	
	Возврат ОписанияОбъектов;
	
КонецФункции

#КонецОбласти
