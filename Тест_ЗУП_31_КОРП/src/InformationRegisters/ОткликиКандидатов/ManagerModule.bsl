#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

Функция НомерПоследнегоОтклика(Вакансия) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Вакансия", Вакансия);
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ОткликиКандидатов.Вакансия КАК Вакансия,
		|	МАКСИМУМ(ОткликиКандидатов.НомерОтклика) КАК НомерОтклика
		|ИЗ
		|	РегистрСведений.ОткликиКандидатов КАК ОткликиКандидатов
		|ГДЕ
		|	ОткликиКандидатов.Вакансия = &Вакансия
		|
		|СГРУППИРОВАТЬ ПО
		|	ОткликиКандидатов.Вакансия";
	Выборка = Запрос.Выполнить().Выбрать();
	
	Если Выборка.Следующий() Тогда
		Возврат Выборка.НомерОтклика;
	КонецЕсли;
	
	Возврат 0; 
	
КонецФункции

#КонецОбласти

#КонецЕсли