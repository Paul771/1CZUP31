#Если Сервер ИЛИ ТолстыйКлиентОбычноеПриложение ИЛИ ВнешнееСоединение Тогда
	
#Область СлужебныеПроцедурыИФункции

Функция ДанныеВопросаДляПросмотра(Вопрос) Экспорт
	
	Если ТипЗнч(Вопрос) = Тип("Массив") Тогда
		МассивВопросов = Вопрос;
	Иначе		
		МассивВопросов = Новый Массив;
		МассивВопросов.Добавить(Вопрос);
	КонецЕсли;
	
	// Формируем таблицу вопросов
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ТестовыеВопросы.Задание КАК Задание,
		|	ТестовыеВопросы.ТипВопроса КАК ТипВопроса,
		|	ТестовыеВопросы.Ссылка КАК Ссылка
		|ИЗ
		|	Справочник.ТестовыеВопросы КАК ТестовыеВопросы
		|ГДЕ
		|	ТестовыеВопросы.ПометкаУдаления = ЛОЖЬ
		|	И ТестовыеВопросы.ЭтоГруппа = ЛОЖЬ
		|	И ТестовыеВопросы.Ссылка В(&МассивВопросов)";
	
	Запрос.УстановитьПараметр("МассивВопросов", МассивВопросов);
	
	ТаблицаВопросов = Запрос.Выполнить().Выгрузить();
	
	// Выбираем варианты ответов	
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ВариантыОтветовНаТестовыеВопросы.Верный КАК Верный,
		|	ВариантыОтветовНаТестовыеВопросы.ТекстВарианта КАК ТекстВарианта,
		|	ВариантыОтветовНаТестовыеВопросы.Ссылка КАК Ссылка,
		|	ВариантыОтветовНаТестовыеВопросы.Код КАК Код,
		|	ВариантыОтветовНаТестовыеВопросы.Владелец КАК Вопрос
		|ИЗ
		|	Справочник.ВариантыОтветовНаТестовыеВопросы КАК ВариантыОтветовНаТестовыеВопросы
		|ГДЕ
		|	ВариантыОтветовНаТестовыеВопросы.ПометкаУдаления = ЛОЖЬ
		|	И ВариантыОтветовНаТестовыеВопросы.Владелец В(&МассивВопросов)";
	
	Запрос.УстановитьПараметр("МассивВопросов", МассивВопросов);
	
	ТаблицаВариантов = Запрос.Выполнить().Выгрузить();
	
	// Завершаем
	
	Возврат Новый Структура("Вопросы, Варианты", ТаблицаВопросов, ТаблицаВариантов);
	
КонецФункции

Функция ТекстЗаданияВопроса(Вопрос, ИспользуетсяФорматированныйДокумент = Неопределено) Экспорт
	ВызватьИсключение НСтр("ru = 'Устаревший вызов'");	
КонецФункции

#КонецОбласти

#КонецЕсли




