&НаКлиенте
Перем Оповещение Экспорт;

&НаКлиенте
Процедура ОК(Команда)
	Если Номер = 0 Тогда 
		СообщениеПользователю = Новый СообщениеПользователю;
		СообщениеПользователю.Текст = "Необходимо указать номер участника";
		СообщениеПользователю.Сообщить();
		Возврат;
	КонецЕсли;
	
	Если РосИн=1 Тогда
		Результат = "ИО-" + Формат(Номер, "ЧЦ=5; ЧВН=; ЧГ=");
	ИначеЕсли РосИн=2 Тогда
		Результат = "ИС-" + Формат(Номер, "ЧЦ=5; ЧВН=; ЧГ=");
	ИначеЕсли РосИн=3 Тогда
		Результат = "РО-" + Формат(Номер, "ЧЦ=5; ЧВН=; ЧГ=");
	КонецЕсли;
	Закрыть(Новый Структура("ИмяОбласти, Результат", ИмяОбласти, Результат));
КонецПроцедуры

&НаКлиенте
Процедура Отмена(Команда)
	Закрыть(Неопределено);
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Параметры.Свойство("АвтоТест") Тогда
		Возврат;
	КонецЕсли;

	Если Параметры.Свойство("ЗначениеОбласти") Тогда
		ЗначениеОбласти = Параметры.ЗначениеОбласти;
	КонецЕсли;
	Если Параметры.Свойство("ИмяОбласти") Тогда
		ИмяОбласти = Параметры.ИмяОбласти;
	КонецЕсли;
	
	Если Параметры.Свойство("ДоступенВыборРО") Тогда
		Элементы.РосИн.СписокВыбора.Добавить(3, "Российская организация");
	КонецЕсли;
	
	Если Параметры.Свойство("НеДоступенВыборИС") Тогда
		Элементы.РосИн.СписокВыбора.Удалить(1);
	КонецЕсли;
	
	Если Параметры.Свойство("ФиксированныйТип") Тогда 
		РосИн = Параметры.ФиксированныйТип;
		Элементы.РосИн.Доступность = Ложь;
	Иначе 
		Тип = Лев(ЗначениеОбласти, 3);
		Если Тип = "ИО-" Тогда 
			РосИн = 1;
		ИначеЕсли Тип = "ИС-" Тогда 
			РосИн = 2;
		ИначеЕсли Тип = "РО-" Тогда 
			РосИн = 3;
		КонецЕсли;
	КонецЕсли;
	
	ОписаниеТипов = Новый ОписаниеТипов("Число");
	Номер = ОписаниеТипов.ПривестиЗначение(Сред(ЗначениеОбласти, 4));
КонецПроцедуры

&НаКлиенте
Процедура Очистить(Команда)
	Закрыть(Новый Структура("ИмяОбласти, Очистить", ИмяОбласти, 0));
КонецПроцедуры
