#Область ОбработчикиСобытий

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	Если ТипЗнч(ПараметрыВыполненияКоманды.Источник) = Тип("УправляемаяФорма") Тогда
		ВнешнийОбъект = новый Структура;
		ВнешнийОбъект.Вставить("id", ПараметрыВыполненияКоманды.Источник.ID);
		ВнешнийОбъект.Вставить("type", ПараметрыВыполненияКоманды.Источник.Тип);
		
		Если Найти(ПараметрыВыполненияКоманды.Источник.Тип,"Document") <> 0 Тогда
			ВнешнийОбъект.Вставить("name", ПараметрыВыполненияКоманды.Источник.Наименование);
			ВнешнийОбъект.Вставить("presentation", ПараметрыВыполненияКоманды.Источник.Представление);
		Иначе
			ВнешнийОбъект.Вставить("presentation", "");
		КонецЕсли;
		
	Иначе
		ВнешнийОбъект = Неопределено;
	КонецЕсли;
	
	ПараметрыФормы = Новый Структура("ВнешнийОбъект",ВнешнийОбъект);
	
	ОткрытьФорму(
		"Обработка.ИнтеграцияС1СДокументооборот.Форма.ТрудозатратыПоОбъекту", 
		ПараметрыФормы, 
		ПараметрыВыполненияКоманды.Источник, 
		ПараметрыВыполненияКоманды.Уникальность, 
		ПараметрыВыполненияКоманды.Окно);

КонецПроцедуры

#КонецОбласти